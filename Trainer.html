<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Blackjack Strategy Trainer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin: 0;
      padding: 0;
      background: #f5f5f5;
      color: #111;
      display: flex;
      justify-content: center;
    }
    .container {
      max-width: 480px;
      width: 100%;
      padding: 16px;
      box-sizing: border-box;
    }
    h1 {
      font-size: 1.6rem;
      margin: 0 0 4px;
      text-align: center;
    }
    .subtitle {
      font-size: 0.85rem;
      color: #555;
      text-align: center;
      margin-bottom: 1rem;
    }
    .card-shell {
      background: #ffffff;
      border-radius: 12px;
      padding: 16px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.08);
      margin-bottom: 12px;
    }
    .row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
    }
    .row > * { flex: 1 1 auto; }
    label { font-size: 0.9rem; }
    input[type="checkbox"] {
      transform: scale(1.1);
      margin-right: 5px;
    }
    .legend {
      font-size: 0.8rem;
      color: #555;
      margin-top: 8px;
    }

    .section-title {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      color: #777;
      margin-bottom: 4px;
    }
    .card-row {
      display: flex;
      gap: 8px;
      margin-bottom: 4px;
    }
    .card-visual {
      width: 56px;
      height: 78px;
      border-radius: 8px;
      background: #ffffff;
      border: 1.5px solid #333;
      box-shadow: 0 2px 4px rgba(0,0,0,0.15);
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .card-corner {
      position: absolute;
      font-size: 0.8rem;
      font-weight: 600;
      line-height: 1;
      white-space: nowrap;
    }
    .card-corner.top {
      top: 4px;
      left: 4px;
    }
    .card-corner.bottom {
      bottom: 4px;
      right: 4px;
      transform: rotate(180deg);
    }
    .card-center {
      font-size: 1.2rem;
      opacity: 0.7;
    }

    .card-visual.black .card-corner,
    .card-visual.black .card-center {
      color: #1a1a1a;
    }

    .card-visual.red .card-corner,
    .card-visual.red .card-center {
      color: #c62828;
    }

    @media (max-width: 600px) {
      .card-visual {
        width: 112px;
        height: 156px;
        border-radius: 12px;
      }
      .card-corner {
        font-size: 1.6rem;
      }
      .card-center {
        font-size: 2.4rem;
      }
      .card-row {
        gap: 12px;
      }
    }

    .hand-meta {
      font-size: 0.85rem;
      color: #444;
      margin-bottom: 8px;
    }
    .tag {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 0.75rem;
      margin-left: 6px;
    }
    .tag-soft { background: #e8f5e9; }
    .tag-hard { background: #e3f2fd; }
    .tag-pair { background: #f3e5f5; }

    .buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 8px;
    }
    button.action-btn {
      flex: 1 1 calc(50% - 8px);
      padding: 10px;
      border-radius: 999px;
      border: none;
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
    }
    .btn-hit    { background: #9ccc65; }
    .btn-stand  { background: #ffb74d; }
    .btn-double { background: #ef5350; color: #fff; }
    .btn-split  { background: #b0bec5; }
    button.action-btn:disabled {
      background: #d1d1d1;
      color: #777;
      cursor: not-allowed;
      opacity: 0.7;
    }

    #newHandBtn {
      width: 100%;
      margin-top: 10px;
      padding: 10px;
      border-radius: 999px;
      border: none;
      background: #1976d2;
      color: #fff;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
    }

    #feedback {
      margin-top: 8px;
      min-height: 1.3em;
      font-size: 0.95rem;
    }
    #feedback.correct {
      color: #2e7d32;
      animation: correctPop 600ms ease-out;
    }
    #feedback.incorrect {
      color: #c62828;
      animation: incorrectShake 500ms ease-out;
    }

    @keyframes correctPop {
      0% { transform: scale(0.9); opacity: 0.4; text-shadow: none; }
      40% { transform: scale(1.08); opacity: 1; text-shadow: 0 0 10px rgba(46,125,50,0.35); }
      100% { transform: scale(1); opacity: 1; text-shadow: none; }
    }

    @keyframes incorrectShake {
      0%, 100% { transform: translateX(0); }
      15% { transform: translateX(-6px); }
      30% { transform: translateX(6px); }
      45% { transform: translateX(-4px); }
      60% { transform: translateX(4px); }
      75% { transform: translateX(-2px); }
      90% { transform: translateX(2px); }
    }

    .stats {
      font-size: 0.85rem;
      color: #444;
      margin-top: 6px;
    }

    .strategy-box {
      margin-top: 12px;
    }
    .strategy-toggle-btn {
      width: 100%;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      padding: 10px 12px;
      border-radius: 8px;
      border: 1px solid #d0d7de;
      background: #f0f4ff;
      color: #1a237e;
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
    }
    .strategy-box.open .strategy-toggle-btn {
      background: #e3f2fd;
    }
    .strategy-toggle-btn:focus {
      outline: none;
      box-shadow: 0 0 0 3px rgba(25, 118, 210, 0.25);
    }
    .strategy-content {
      margin-top: 12px;
      font-size: 0.8rem;
      color: #333;
    }
    .strategy-content.hidden {
      display: none;
    }
    .strategy-section-title {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: #555;
      margin: 16px 0 6px;
    }
    .strategy-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.74rem;
    }
    .strategy-table th,
    .strategy-table td {
      border: 1px solid #d0d7de;
      padding: 6px 4px;
      text-align: center;
    }
    .strategy-table th {
      background: #e8f0fe;
      color: #1a237e;
      font-weight: 600;
    }
    .strategy-note {
      font-size: 0.7rem;
      color: #555;
      margin-top: 8px;
    }
  </style>
</head>
<body>
<div class="container">

  <h1>Blackjack Strategy Trainer</h1>
  <div class="subtitle">Practice basic strategy: hard, soft, and pairs.</div>

  <div class="card-shell">
    <div class="row">
      <label><input type="checkbox" id="onlySoft"> Soft hands only</label>
    </div>
    <div class="row" style="margin-top:4px;">
      <label><input type="checkbox" id="onlyPairs"> Pairs only</label>
    </div>
    <div class="legend">
      Actions: H = Hit, ST = Stand, D = Double, SP = Split.
    </div>
  </div>

  <div class="card-shell">
    <div id="dealerArea">
      <div class="section-title">Dealer Upcard</div>
      <div class="card-row" id="dealerCards"></div>
    </div>

    <div id="playerArea" style="margin-top:12px;">
      <div class="section-title">Your Hand</div>
      <div class="card-row" id="playerCards"></div>
      <div class="hand-meta" id="playerMeta"></div>
    </div>

    <div class="buttons">
      <button class="action-btn btn-hit"    data-action="H">Hit</button>
      <button class="action-btn btn-stand"  data-action="ST">Stand</button>
      <button class="action-btn btn-double" data-action="D">Double</button>
      <button class="action-btn btn-split"  data-action="SP">Split</button>
    </div>

    <button id="newHandBtn">New Hand</button>

    <div id="feedback"></div>
    <div class="stats" id="stats"></div>
  </div>

  <div class="card-shell strategy-box" id="strategyBox">
    <button type="button" class="strategy-toggle-btn" id="strategyToggle">
      <span class="toggle-label">Show Strategy Table</span>
      <span class="chevron">▼</span>
    </button>
    <div class="strategy-content hidden" id="strategyContent">
      <p>Use this reference to double-check recommended plays for common player hands versus the dealer upcard.</p>

      <div class="strategy-section-title">Hard Totals</div>
      <table class="strategy-table">
        <thead>
          <tr>
            <th>Player Total</th>
            <th>Dealer 2-6</th>
            <th>Dealer 7-9</th>
            <th>Dealer 10-A</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>5-8</td><td>Hit</td><td>Hit</td><td>Hit</td></tr>
          <tr><td>9</td><td>Double</td><td>Hit</td><td>Hit</td></tr>
          <tr><td>10</td><td>Double</td><td>Double</td><td>Hit</td></tr>
          <tr><td>11</td><td>Double</td><td>Double</td><td>Double (Hit vs A)</td></tr>
          <tr><td>12</td><td>Stand</td><td>Hit</td><td>Hit</td></tr>
          <tr><td>13-16</td><td>Stand</td><td>Hit</td><td>Hit</td></tr>
          <tr><td>17+</td><td>Stand</td><td>Stand</td><td>Stand</td></tr>
        </tbody>
      </table>

      <div class="strategy-section-title">Soft Totals</div>
      <table class="strategy-table">
        <thead>
          <tr>
            <th>Player Hand</th>
            <th>Dealer 2-6</th>
            <th>Dealer 7-8</th>
            <th>Dealer 9-A</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>A,2 / A,3</td>
            <td>Double vs 5-6 (otherwise Hit)</td>
            <td>Hit</td>
            <td>Hit</td>
          </tr>
          <tr>
            <td>A,4 / A,5</td>
            <td>Double vs 4-6 (otherwise Hit)</td>
            <td>Hit</td>
            <td>Hit</td>
          </tr>
          <tr>
            <td>A,6</td>
            <td>Double vs 3-6 (otherwise Hit)</td>
            <td>Hit</td>
            <td>Hit</td>
          </tr>
          <tr>
            <td>A,7</td>
            <td>Double vs 3-6 (Stand vs 2)</td>
            <td>Stand</td>
            <td>Hit</td>
          </tr>
          <tr><td>A,8 / A,9</td><td>Stand</td><td>Stand</td><td>Stand</td></tr>
        </tbody>
      </table>

      <div class="strategy-section-title">Pairs</div>
      <table class="strategy-table">
        <thead>
          <tr>
            <th>Pair</th>
            <th>Dealer 2-6</th>
            <th>Dealer 7-9</th>
            <th>Dealer 10-A</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>A,A</td><td>Split</td><td>Split</td><td>Split</td></tr>
          <tr><td>10,10</td><td>Stand</td><td>Stand</td><td>Stand</td></tr>
          <tr><td>9,9</td><td>Split (Stand vs 7)</td><td>Stand</td><td>Stand</td></tr>
          <tr><td>8,8</td><td>Split</td><td>Split</td><td>Split</td></tr>
          <tr><td>7,7</td><td>Split</td><td>Hit</td><td>Hit</td></tr>
          <tr><td>6,6</td><td>Split</td><td>Hit</td><td>Hit</td></tr>
          <tr><td>5,5</td><td>Double</td><td>Double</td><td>Hit</td></tr>
          <tr><td>4,4</td><td>Hit (Split vs 5-6)</td><td>Hit</td><td>Hit</td></tr>
          <tr><td>2,2 / 3,3</td><td>Split</td><td>Hit</td><td>Hit</td></tr>
        </tbody>
      </table>

      <div class="strategy-note">Rules vary by casino. This guide assumes 4-8 decks, dealer stands on soft 17, and doubling after split is allowed.</div>
    </div>
  </div>

</div>

<script>
function randInt(a,b){return Math.floor(Math.random()*(b-a+1))+a;}
function up(v){return v===11?"A":String(v);}

const SUITS = [
  { symbol: "♠", className: "black" },
  { symbol: "♥", className: "red" },
  { symbol: "♣", className: "black" },
  { symbol: "♦", className: "red" }
];

function randomSuit(){
  return SUITS[randInt(0, SUITS.length-1)];
}

// Basic strategy (same logic as before)
function basicStrategy(p,u){
  if(p.isPair){
    let r=p.pairRank;
    if(r===11) return "SP";
    if(r===10) return "ST";
    if(r===9) return (u===7||u===10||u===11)?"ST":"SP";
    if(r===8) return "SP";
    if(r===7) return (u>=2&&u<=7)?"SP":"H";
    if(r===6) return (u>=2&&u<=6)?"SP":"H";
    if(r===5) return (u>=2&&u<=9)?"D":"H";
    if(r===4) return (u===5||u===6)?"SP":"H";
    if(r===3||r===2) return (u>=2&&u<=7)?"SP":"H";
  }
  if(p.soft){
    let t=p.total;
    if(t===13||t===14) return (u===5||u===6)?"D":"H";
    if(t===15||t===16) return (u>=4&&u<=6)?"D":"H";
    if(t===17) return (u>=3&&u<=6)?"D":"H";
    if(t===18){
      if(u>=3&&u<=6) return "D";
      if(u===2||u===7||u===8) return "ST";
      return "H";
    }
    if(t===19||t===20) return "ST";
  }
  let t=p.total;
  if(t<=8) return "H";
  if(t===9)  return (u>=3&&u<=6)?"D":"H";
  if(t===10) return (u>=2&&u<=9)?"D":"H";
  if(t===11) return (u!==11)?"D":"H";
  if(t===12) return (u>=4&&u<=6)?"ST":"H";
  if(t>=13&&t<=16) return (u>=2&&u<=6)?"ST":"H";
  return "ST";
}

// Player generator (same types, but we'll build visual cards separately)
function genPlayer(onlySoft,onlyPairs){
  let type;
  if(onlyPairs) type="pair";
  else if(onlySoft) type="soft";
  else type=["pair","soft","hard"][randInt(0,2)];

  if(type==="soft"){
    let o=randInt(2,9);
    return {soft:true,isPair:false,total:11+o,other:o,pairRank:null};
  }
  if(type==="pair"){
    let r=[2,3,4,5,6,7,8,9,10,11][randInt(0,9)];
    return {soft:false,isPair:true,pairRank:r,total:r*2};
  }
  let t=randInt(5,17);
  return {soft:false,isPair:false,pairRank:null,total:t};
}

// Decide how to describe the hand in words
function metaDescription(p){
  if(p.isPair){
    let label = (p.pairRank===11?"A":String(p.pairRank));
    return {text:`Pair of ${label}s (${p.total})`, tag:"pair"};
  }
  if(p.soft){
    return {text:`Soft ${p.total} (A + ${p.other})`, tag:"soft"};
  }
  return {text:`Hard ${p.total}`, tag:"hard"};
}

// Build a plausible 2-card representation (visual only)
function getPlayerRanks(p){
  if(p.isPair){
    let r = p.pairRank===11 ? "A" : String(p.pairRank===10 ? 10 : p.pairRank);
    return [r,r];
  }
  if(p.soft){
    return ["A", String(p.other)];
  }
  // hard total: build two ranks that sum to p.total, avoid A so it's clearly hard
  let t = p.total;
  let r1, r2;
  if(t <= 10){
    r1 = Math.max(2, t-8); // keep within 2–10
    r2 = t - r1;
    if(r2 < 2){ r2 = 2; r1 = t - r2; }
  } else if (t === 11){
    r1 = 6; r2 = 5;
  } else {
    r1 = 10;
    r2 = t - 10;
    if(r2 < 2 || r2 > 10){
      r1 = 9;
      r2 = t - 9;
      if(r2 < 2 || r2 > 10){
        r1 = 8;
        r2 = t - 8;
      }
    }
  }
  return [String(r1), String(r2)];
}

// Card HTML
function cardHTML(rank){
  const suit = randomSuit();
  return `
    <div class="card-visual ${suit.className}">
      <div class="card-corner top">${rank}${suit.symbol}</div>
      <div class="card-center">${suit.symbol}</div>
      <div class="card-corner bottom">${rank}${suit.symbol}</div>
    </div>
  `;
}

// State
let current, dealer, correct;
let handResolved = false;
let stats={total:0,correct:0};

const onlySoftCheckbox  = document.getElementById("onlySoft");
const onlyPairsCheckbox = document.getElementById("onlyPairs");
const playerCardsEl = document.getElementById("playerCards");
const playerMetaEl  = document.getElementById("playerMeta");
const dealerCardsEl = document.getElementById("dealerCards");
const feedbackEl    = document.getElementById("feedback");
const statsEl       = document.getElementById("stats");
const strategyToggleBtn = document.getElementById("strategyToggle");
const strategyContent = document.getElementById("strategyContent");
const strategyBox = document.getElementById("strategyBox");
const actionButtons = Array.from(document.querySelectorAll(".action-btn"));

function updateStats(){
  let pct = stats.total ? Math.round(100*stats.correct/stats.total) : 0;
  statsEl.textContent = `Hands: ${stats.total} | Correct: ${stats.correct} (${pct}%)`;
}

function setActionButtonsDisabled(disabled){
  actionButtons.forEach(btn=>{
    btn.disabled = disabled;
  });
}

function newHand(){
  let onlySoft  = onlySoftCheckbox.checked;
  let onlyPairs = onlyPairsCheckbox.checked;

  dealer  = randInt(2,11);
  current = genPlayer(onlySoft,onlyPairs);
  correct = basicStrategy(current,dealer);

  // Render player cards
  let ranks = getPlayerRanks(current);
  playerCardsEl.innerHTML = ranks.map(cardHTML).join("");

  // Meta info
  let meta = metaDescription(current);
  let tagClass = meta.tag==="soft" ? "tag-soft" :
                 meta.tag==="hard" ? "tag-hard" :
                 "tag-pair";
  playerMetaEl.innerHTML =
    `${meta.text}<span class="tag ${tagClass}">${meta.tag}</span>`;

  // Render dealer upcard
  let dRank = up(dealer);
  dealerCardsEl.innerHTML = cardHTML(dRank);

  feedbackEl.textContent = "";
  feedbackEl.className = "";
  handResolved = false;
  setActionButtonsDisabled(false);
}

function actionToWords(a){
  switch(a){
    case "H": return "HIT";
    case "ST": return "STAND";
    case "D": return "DOUBLE";
    case "SP": return "SPLIT";
    default: return a;
  }
}

// Button handlers
actionButtons.forEach(btn=>{
  btn.onclick = e=>{
    if(!current || handResolved) return;
    let chosen = e.currentTarget.getAttribute("data-action");
    stats.total++;
    if(chosen===correct){
      stats.correct++;
      feedbackEl.textContent = "Correct! Recommended play is " + actionToWords(correct) + ".";
      feedbackEl.className = "correct";
    }else{
      feedbackEl.textContent =
        "Incorrect. You chose " + actionToWords(chosen) +
        ", but basic strategy says " + actionToWords(correct) + ".";
      feedbackEl.className = "incorrect";
    }
    updateStats();
    handResolved = true;
    setActionButtonsDisabled(true);
  };
});

document.getElementById("newHandBtn").onclick = newHand;

onlySoftCheckbox.addEventListener("change", () => {
  if (onlySoftCheckbox.checked) {
    onlyPairsCheckbox.checked = false;
  }
});

onlyPairsCheckbox.addEventListener("change", () => {
  if (onlyPairsCheckbox.checked) {
    onlySoftCheckbox.checked = false;
  }
});

if(strategyToggleBtn){
  strategyToggleBtn.addEventListener("click", ()=>{
    const isHidden = strategyContent.classList.toggle("hidden");
    strategyBox.classList.toggle("open", !isHidden);
    strategyToggleBtn.querySelector(".toggle-label").textContent = isHidden ? "Show Strategy Table" : "Hide Strategy Table";
    strategyToggleBtn.querySelector(".chevron").textContent = isHidden ? "▼" : "▲";
  });
}

// Init
updateStats();
newHand();
</script>

</body>
</html>
